<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-14</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Set up

draw            = 1;
alpha[0]        = 0;
alpha[1]        = 0;
alpha[2]        = 0;
alpha[3]        = 0;
die             = 0;
die_alpha       = 0;
effect_scale    = 1;
draw_bestiary   = 0;
temp_inv        = 0;
temp_inv2       = 0;
draw_stats      = 0;
stats_alpha     = 0;
draw_quest      = 0;
effect_scale2   = 1;
skillPointsA    = 0.5;
skillPointsM    = 0;
Sname           = part_system_create();
ticks           = 0;
maxTicks        = 30;
draw_crafting   = 0;
scale_crafting  = 1;
draw_equipment  = 0;
scale_equipment = 1;
draw_status     = 0;
scale_status    = 1;
spellsxPlus     = 16;
expxPlus        = 8;
craftingHelper  = -1;
craftingTitle   = "Výroba";
craftingMenuAlpha = 1;
craftingMenuIndex[0] = "Vytvořit předmět";
craftingMenuIndex[1] = "Vylepšit předmět";
craftingMenuIndex[2] = "Zušlechtit materiál";
craftingTitleHelper = "";

drawCraftingMenu = 1;
craftingSelectedIndex = -1;
selectedIndexY = -1;
craftingPageSelected = 0;
craftingKnownItems = ds_list_create();
craftingItemsNewFlag[0, 48] = false;
craftingEntriesPerPage = 48;
craftingEntriesPerRow  = 8;
craftingItemsSprite[0, 48] = 0;
craftingItemsName[0, 48] = "";
craftingSelectedItem = -1;
craftingDetails = false;
craftingDetailsHeight = 0;
craftingDetailsAlpha = 0;
craftingSlot[10, 5] = 0;
craftingDetailsText[0, 48] = "";
craftingTitleHelper2 = "";

craftingSlotFree[10] = true;
craftingSlotSprite[10] = -1;
craftingSlotID[10] = 0;
craftingSlotItemID[10] = -1;
craftingSlotNumber[10] = -1;

upgradingItemID = -1;
upgradingItemSprite = 0;
upgradingItemSlotID = -1;

enchantItemID[3] = -1;
enchantItemSprite[3] = 0;
enchantItemSlotID[3] = -1;

enrichtItemID = -1;
enrichtItemSprite = 0;
enrichtItemSlotID = -1;
enrichtingOutputSprite = 0;
// TEST
craftingItemsSprite[0, 3] = 3; // Wooden sword
scrCraftingSetItemKnown(3, "Dřevěný meč", "Poškození: " + scrColorflag(c_lime) + "5" + scrEndColorflag() + " - " + scrColorflag(c_lime) + "8#" + scrEndColorflag() + "Stamina na úder: " + scrColorflag(c_red) + "4 " + scrEndColorflag() + "- " + scrColorflag(c_red) + "5#");


iconActive[hudIcons.bestiary]  = true;
iconActive[hudIcons.inventory] = true;
iconActive[hudIcons.quest]     = true;
iconActive[hudIcons.crafting]  = false;
iconActive[hudIcons.equipment] = false;
iconActive[hudIcons.status]    = true;

iconAlpha[hudIcons.bestiary]  = 1;
iconAlpha[hudIcons.inventory] = 1;
iconAlpha[hudIcons.quest]     = 1;
iconAlpha[hudIcons.crafting]  = 0.6;
iconAlpha[hudIcons.equipment] = 0.6;
iconAlpha[hudIcons.status]    = 1;

normalxoffset = (view_wview - view_wview); 
halfxoffset   = (normalxoffset / 2)
spellsxPlus  += halfxoffset;
yoffset       = (view_hview - view_hview);

baseFormulaX = (x + 540);
spellMinY    = (y + 560 + yoffset - 10);
spellMaxY    = (y + 560 + yoffset + 30);

can_draw = false;

scrAchievementRegister(0, "Objevil jsi Simplex!", "Vítej, vývojáři.", 0, medalEnum.diamond);

scrAchievementUnlock(0);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy PSystem

part_system_destroy(Sname);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Jump to player position

if (instance_number(oPlayer) &gt; 0) {x = oPlayer.x; y = oPlayer.y;}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw HUD

x = view_xview;
y = view_yview;

if (instance_number(oPlayer) &gt; 0 &amp;&amp; draw)
{ 
// Call update scripts
scrAffectsUpdate();      
apiPlayerUpdateProperties();

// Reset draw mode + set text align to center
clr();
alg("center", fntPixelSmall);    

// Draw HUD bars (hp, shield, mana, stamina) + experience bar
scrHudDrawBar(600, 0, 2, 10, 1, oPlayer.last_hp, oPlayer.vlastnost[vlastnost_max_zivot], 0);
scrHudDrawBar(600, 30, 4, 11, 2, oPlayer.last_stit, oPlayer.vlastnost[vlastnost_max_stit], 1);
scrHudDrawBar(600, 60, 0, 9, 0, oPlayer.last_mana, oPlayer.vlastnost[vlastnost_max_mana], 2);
scrHudDrawBar(600, 90, 6, 12, 3, oPlayer.last_stamina, oPlayer.vlastnost[vlastnost_max_stamina], 3);
scrHudDrawXpBar(275, 571);

// Draw binded spells
alg("default", fntPixelHuge);

       draw_sprite(sSpellsUI,0,x+540+spellsxPlus,y+560+yoffset);
       if (oPlayer.spell[0] = "")
       {
       draw_set_alpha(0.4);
       draw_text(x+551+spellsxPlus,y+562+yoffset,"J");
       draw_set_alpha(1);
       }
       else 
            {
            draw_sprite(oPlayer.spell_sprite[0],0,x+540+spellsxPlus,y+560+yoffset);              
            draw_set_alpha(0.4);
            if (oPlayer.spell_cd[0] &gt; 0) {draw_rectangle_cd(x+540+3+spellsxPlus,y+560+3+yoffset,x+572+spellsxPlus,y+592+yoffset,360-((oPlayer.spell_cd[0] / oPlayer.temp_cd[0])*360))}
            draw_set_alpha(1);           
            draw_sprite(sSpellsUI,1,x+540+spellsxPlus,y+560+yoffset); 
            draw_set_font(fntPixelSmall);  
            draw_text_colour(x+559+spellsxPlus,y+572+yoffset,"J",c_black,c_black,c_black,c_black,1); 
            draw_text_colour(x+560+spellsxPlus,y+572+yoffset,"J",c_white,c_white,c_white,c_white,1);  
            draw_set_font(fntPixelHuge);
            }
       draw_sprite(sSpellsUI,0,x+584+spellsxPlus,y+560+yoffset);
       if (oPlayer.spell[1] = "")
       {
        draw_set_alpha(0.4);
       draw_text(x+595+spellsxPlus,y+562+yoffset,"K");
       draw_set_alpha(1);
       }
       else 
            {
            draw_sprite(oPlayer.spell_sprite[1],0,x+584+spellsxPlus,y+560+yoffset); 
            draw_set_alpha(0.4);
            if (oPlayer.spell_cd[1] &gt; 0) {draw_rectangle_cd(x+584+3+spellsxPlus,y+560+3+yoffset,x+616+spellsxPlus,y+592+yoffset,360-((oPlayer.spell_cd[1] / oPlayer.temp_cd[1])*360))}
            draw_set_alpha(1);           
            draw_sprite(sSpellsUI,1,x+584+spellsxPlus,y+560+yoffset);
            draw_set_font(fntPixelSmall);  
            draw_text_colour(x+602+spellsxPlus,y+572+yoffset,"K",c_black,c_black,c_black,c_black,1); 
            draw_text_colour(x+603+spellsxPlus,y+572+yoffset,"K",c_white,c_white,c_white,c_white,1);  
            draw_set_font(fntPixelHuge);

            }
       draw_sprite(sSpellsUI,0,x+628+spellsxPlus,y+560+yoffset);
       if (oPlayer.spell[2] = "")
       {
        draw_set_alpha(0.4);
       draw_text(x+640+spellsxPlus,y+561+yoffset,"L");
       draw_set_alpha(1);
       }
       else 
            {
            draw_sprite(oPlayer.spell_sprite[2],0,x+628+spellsxPlus,y+560+yoffset);  
            draw_set_alpha(0.4);
            if (oPlayer.spell_cd[2] &gt; 0) {draw_rectangle_cd(x+628+3+spellsxPlus,y+560+3+yoffset,x+660+spellsxPlus,y+592+yoffset,360-((oPlayer.spell_cd[2] / oPlayer.temp_cd[2])*360))}
            draw_set_alpha(1);     
            draw_sprite(sSpellsUI,1,x+628+spellsxPlus,y+560+yoffset);
             draw_set_font(fntPixelSmall);  
            draw_text_colour(x+645+spellsxPlus,y+572+yoffset,"L",c_black,c_black,c_black,c_black,1); 
            draw_text_colour(x+646+spellsxPlus,y+572+yoffset,"L",c_white,c_white,c_white,c_white,1);  
            draw_set_font(fntPixelHuge);

            }

       
     // Black outline alpha UP
     if (effect_scale2   &lt; 1.2 &amp;&amp; draw_quest)     {effect_scale2   += 0.02;}          
     if (effect_scale    &lt; 1.2 &amp;&amp; draw_bestiary)  {effect_scale    += 0.02;}
     if (scale_crafting  &lt; 1.2 &amp;&amp; draw_crafting)  {scale_crafting  += 0.02;}
     if (scale_equipment &lt; 1.2 &amp;&amp; draw_equipment) {scale_equipment += 0.02;}
     if (scale_status    &lt; 1.2 &amp;&amp; draw_status)    {scale_status    += 0.02;}
 
     // Draw outline
     tempAlpha = min(0.7, iconAlpha[hudIcons.bestiary]);
     if (iconAlpha[hudIcons.bestiary] &lt; 1) {tempAlpha = 0;}
     draw_sprite_ext(sBestiary,0,view_xview+8+16,view_yview+560+16+yoffset,effect_scale,effect_scale,0,c_black,tempAlpha);
     tempAlpha = min(0.7, iconAlpha[hudIcons.crafting]);
     if (iconAlpha[hudIcons.crafting]  &lt; 1) {tempAlpha = 0;}
     draw_sprite_ext(sCrafting,0,view_xview+16+128,view_yview+560+16+yoffset,scale_crafting,scale_crafting,0,c_black,tempAlpha);
     tempAlpha = min(0.7, iconAlpha[hudIcons.equipment]);
     if (iconAlpha[hudIcons.equipment]  &lt; 1) {tempAlpha = 0;}
     draw_sprite_ext(sEquipment,0,view_xview+24+128+32,view_yview+560+16+yoffset,scale_equipment,scale_equipment,0,c_black,tempAlpha);
     tempAlpha = min(0.7, iconAlpha[hudIcons.status]);
     if (iconAlpha[hudIcons.status]  &lt; 1) {tempAlpha = 0;}
     draw_sprite_ext(sStatus,0,view_xview+32+128+64,view_yview+560+16+yoffset,scale_status,scale_status,0,c_black,tempAlpha);
     tempAlpha = min(0.7, iconAlpha[hudIcons.quest]);
     if (iconAlpha[hudIcons.quest]  &lt; 1) {tempAlpha = 0;}
     draw_sprite_ext(sQuestIcon,0,view_xview+96+8,view_yview+560+16+yoffset,effect_scale2,effect_scale2,0,c_black,tempAlpha);

     
     // Draw full icons
     draw_sprite_ext(sBestiary,  0, (view_xview + 24 ), (view_yview + 576 + yoffset), iconAlpha[hudIcons.bestiary],  iconAlpha[hudIcons.bestiary],  0, c_white, iconAlpha[hudIcons.bestiary]);
     draw_sprite_ext(sCrafting,  0, (view_xview + 144), (view_yview + 576 + yoffset), iconAlpha[hudIcons.crafting],  iconAlpha[hudIcons.crafting],  0, c_white, iconAlpha[hudIcons.crafting]);
     draw_sprite_ext(sEquipment, 0, (view_xview + 184), (view_yview + 576 + yoffset), iconAlpha[hudIcons.equipment], iconAlpha[hudIcons.equipment], 0, c_white, iconAlpha[hudIcons.equipment]);
     draw_sprite_ext(sStatus,    0, (view_xview + 224), (view_yview + 576 + yoffset), iconAlpha[hudIcons.status],    iconAlpha[hudIcons.status],    0, c_white, iconAlpha[hudIcons.status]);
     draw_sprite_ext(sQuestIcon, 0, (view_xview + 104), (view_yview + 576 + yoffset), iconAlpha[hudIcons.quest],     iconAlpha[hudIcons.quest],     0, c_white, iconAlpha[hudIcons.quest]);

     // Adjust full icons alpha
     for (i = 0; i &lt; array_length_1d(iconAlpha); i++)
        {
        if (iconAlpha[i] &lt; 1   &amp;&amp; iconActive[i])  {iconAlpha[i] = lerp(iconAlpha[i], 1.02, 0.05);}   // Increase
        if (iconAlpha[i] &gt; 0.6 &amp;&amp; !iconActive[i]) {iconAlpha[i] = lerp(iconAlpha[i], 0.61, 0.05);} // Decrease
        }
 
     // Black outline alpha DOWN
     if (effect_scale    &gt; 1 &amp;&amp; !draw_bestiary)  {effect_scale    -= 0.02;}
     if (scale_crafting  &gt; 1 &amp;&amp; !draw_crafting)  {scale_crafting  -= 0.02;}
     if (scale_equipment &gt; 1 &amp;&amp; !draw_equipment) {scale_equipment -= 0.02;}
     if (scale_status    &gt; 1 &amp;&amp; !draw_status)    {scale_status    -= 0.02;}
     if (effect_scale2   &gt; 1 &amp;&amp; !draw_quest)     {effect_scale2   -= 0.02;}
     
     // Navigation
     //********************************************************************
     
     // Quest
        if (keyboard_check_pressed(ord("Q")) &amp;&amp; iconActive[hudIcons.quest])
        {
        draw_quest = ! draw_quest;
        if (instance_number(oQuest) &gt; 0) {oQuest.active = !oQuest.active;}
        
        if (draw_quest) {iconActive[hudIcons.status] = false; iconActive[hudIcons.inventory] = false;}
        else {iconActive[hudIcons.status] = true; iconActive[hudIcons.inventory] = true;}
        }
     // Crafting
        if (keyboard_check_pressed(ord("R")) &amp;&amp; iconActive[hudIcons.crafting])
        {
        draw_crafting = !draw_crafting;
        
        if (draw_crafting) {iconActive[hudIcons.equipment] = false;}
        else {iconActive[hudIcons.equipment] = true;}
        }        
     // Equipment
        if (keyboard_check_pressed(ord("E")) &amp;&amp; iconActive[hudIcons.equipment])
        {
        draw_equipment = !draw_equipment;
        
        if (draw_equipment) {iconActive[hudIcons.crafting] = false;}
        else {iconActive[hudIcons.crafting] = true;}

        oInventory.draw_equipment = draw_equipment;
        }  
     // Status
        if (keyboard_check_pressed(ord("T")) &amp;&amp; iconActive[hudIcons.status])
        {
        draw_status = !draw_status;
        if (instance_number(oStatusMenu) &gt; 0) {oStatusMenu.activated = !oStatusMenu.activated;}
        }  
    // Bestiář   
     if (keyboard_check_pressed(ord("B")) &amp;&amp; iconActive[hudIcons.bestiary])
        {
        draw_bestiary = ! draw_bestiary;
        if (instance_number(oBestiar) &gt; 0) {oBestiar.activated = !oBestiar.activated;}
        }                  
        
// Draw crafting
if (draw_crafting) {scrCraftingDraw();}

}
   
if (oPlayer.last_hp &lt;= 0) { die = 1; oPlayer.can_move2 = 0;}     
if (die)
{
        die_alpha += 0.05;
        draw_set_color(c_black);
        draw_set_alpha(die_alpha);
        draw_rectangle(view_xview,view_yview,view_xview+view_wview,view_yview+view_hview,0);
        
        if (die_alpha &gt;= 1) {game_restart();}
}

// Spell switching
/// Spell switching

/*
Athor: @VaclavVal
Revision: @LoFCZ
Version: 1.1
*/

normalxoffset = (view_wview - view_wview); 
halfxoffset   = (normalxoffset / 2)
spellsxPlus  += halfxoffset;
yoffset       = (view_hview - view_hview);

baseFormulaX = (x + 540 + spellsxPlus);
spellMinY    = (y + 560 + yoffset - 10);
spellMaxY    = (y + 560 + yoffset + 30);

for (i = 0; i &lt; 3; i++)
    {
     spellMinX[i] = (baseFormulaX + (44 * i) - 8);
     spellMaxX[i] = (baseFormulaX + (44 * i) + 30);     
    }

// Pick up spell
for (i = 0; i &lt; 3; i++)
    {
     if (mouse_check_button_pressed(mb_left))
        {
         if (mouse_in(spellMinX[i], spellMaxX[i], spellMinY, spellMaxY))
            {
             spell_transformed_index = i;
             can_draw = true;
             break;
            }
        }
    }
    
// Put spell to the new slot
if (mouse_check_button_released(mb_left))
   {
    can_draw = false;
    
    for (i = 0; i &lt; 3; i++)
        {
         if (mouse_in(spellMinX[i], spellMaxX[i], spellMinY, spellMaxY))
            {
             // Store temp vars
             spell_transformed_index2 = i;             
             spell_value              = oPlayer.spell[spell_transformed_index];
             spell_value2             = oPlayer.spell_sprite[spell_transformed_index];
             spell_cd_switch          = oPlayer.spell_cd[spell_transformed_index];
             spell_cd_switch2         = oPlayer.temp_cd[spell_transformed_index];
                   
             // Switch actual values
             oPlayer.spell[spell_transformed_index]         = oPlayer.spell[spell_transformed_index2];
             oPlayer.spell[spell_transformed_index2]        = spell_value;
             oPlayer.spell_cd[spell_transformed_index]      = oPlayer.spell_cd[spell_transformed_index2];
             oPlayer.spell_cd[spell_transformed_index2]     = spell_cd_switch;
             oPlayer.temp_cd[spell_transformed_index]       = oPlayer.temp_cd[spell_transformed_index2];
             oPlayer.temp_cd[spell_transformed_index2]      = spell_cd_switch2;
             oPlayer.spell_sprite[spell_transformed_index]  = oPlayer.spell_sprite[spell_transformed_index2];
             oPlayer.spell_sprite[spell_transformed_index2] = spell_value2;             
             break;
            }          
        }
    }    
       
// Draw temp spell
if (can_draw)
    {
     draw_sprite(oPlayer.spell_sprite[spell_transformed_index], 0, (mouse_x - 16), (mouse_y - 16));
    }
   
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
